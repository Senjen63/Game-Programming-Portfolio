#include "GraphicsBuffer.h"

using namespace std;

GraphicsBuffer::GraphicsBuffer(ALLEGRO_BITMAP* bitmap) 
{
	mBitmap = bitmap;
	assert(mBitmap);

	mOwnsBitmap = false;
}

GraphicsBuffer::GraphicsBuffer(int width, int height) 
{
	mBitmap = al_create_bitmap(width, height);
	assert(mBitmap);

	mOwnsBitmap = false;
}

GraphicsBuffer::GraphicsBuffer(string filename) 
{
	mBitmap = al_load_bitmap(filename.c_str());
	assert(mBitmap);

	mOwnsBitmap = true;
}

GraphicsBuffer::~GraphicsBuffer() 
{
	if (mOwnsBitmap) { al_destroy_bitmap(mBitmap); }
}

void GraphicsBuffer::setColor(Color col) 
{
	ALLEGRO_BITMAP* oldBitmap = al_get_target_bitmap();
	al_set_target_bitmap(mBitmap);
	al_clear_to_color(col.mColor);
	al_set_target_bitmap(oldBitmap);
}