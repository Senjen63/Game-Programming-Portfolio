#pragma once

#include <cassert>

#include <PerformanceTracker.h>
#include <Timer.h>
#include <string>
#include <fstream>

#include "GraphicsBufferManager.h"

#include "InputSystem.h"

//#include "UnitManager.h": Defined in TobbManager
#include "LevelManager.h"
#include "DataManager.h"

#include "AnimationManager.h"
#include "TobbManager.h"
#include "FriendManager.h"
#include "TreeManager.h"
#include "BabbManager.h"

#include "EventSystem.h"
#include "EventListener.h"

#include "Menu.h"
#include "HUD.h"
#include "SFX.h"

#include "DataManager.h"

#include "TobbManager.h"
#include "TreeManager.h"
#include "BabbManager.h"


//EVENTS.h
#include "GameEvent.h"

using namespace std;

//DISPLAY
const int SCREEN_WIDTH = 640;
const int SCREEN_HEIGHT = 640;

//Files Paths
const string FILE_PATH = "assets\\";
const string AUDIO_PATH = "Sound\\";
const string FONT_PATH = "font\\";
const string STICKER_1 = FILE_PATH + "sticker_1.png";

const string FONT_FILENAME = FILE_PATH + FONT_PATH + "handwriting.ttf";

//const char* BABB_FILENAME = "assets\\sprites\\babb.png";
//const char* TREE_FILENAME = "assets\\sprites\\tree-with-apple.png";

//Sounds
const string EAT_SOUND = "eatSound";
const string BABB_SOUND = "babbSound";
const string FRIEND_SOUND = "friendSound";
const string TOBB_SOUND = "tobbSound";
const string TREE_THUNK_SOUND = "treeThunkSound";

//textFiles
const string LOAD_FILE = "LoadFile.txt";
//const string HARD_LEVEL = "HardLevel.txt";
//const string MEDIUM_LEVEL = "MediumLevel.txt";
//const string EASY_LEVEL = "EasyLevel.txt";

//Level Difficulty
const string EASY_DIF = "easy";
const string MEDIUM_DIF = "medium";
const string HARD_DIF = "hard";

//Level Data
//const string FRIEND_STATE_DATA = "friendState";

//Buffers Keys
const string BACKGROUND = "background";
const string BABB = "babb";
const string TREE_A = "treeFull";
const string TREE_B = "treeWithoutApple";

const string HAPPY = "happyFriend";
const string MEH = "mehFriend";
const string SAD = "sadFriend";

const string FRONT = "frontTobb";
const string BACK = "backTobb";
const string LEFT = "leftTobb";
const string RIGHT = "rightTobb";

const string FRONT_A = "frontTobbWithApple";
const string BACK_A = "backTobbWithApple";
const string LEFT_A = "leftTobbWithApple";
const string RIGHT_A = "rightTobbWithApple";

static class Game : public EventListener
{
private:

	static Game* mpGameInst;
	Game(int width, int height);

	Game();
	~Game();

	SFX mSFX;
	DataManager mDataManager;
	TobbManager mTobbManager;
	FriendManager mFriendManager;
	TreeManager mTreeManager;
	BabbManager mBabbManager;

	GraphicsSystem* mpGraphicsSystem;
	Font* mpFont;
	HUD* mpHUD; 
	Menu* mpMenu;

	GraphicsBufferManager* mpGraphicsBufferManager;
	AnimationManager* mpAnimationManager;
	UnitManager* mpUnitManager;

	EventSystem* mpEventSystem;
	InputSystem* mpInputSystem;

	// Gameplay variables
	bool mContinueGame = true;
	bool mHasApple = false;
	int mFriendIndex = -1;
	int mSadFriends = 0;
	int mHappyFriends = 0;

	//PlayGame
	//************************
	string mFriendCounter;
	bool onGameStart = true;
	bool mStateMeh = false;
	bool mStateHappy = false;
	int friendStateChanged = 0;
	//************************

	//Menu Booleans
	//*************************
	bool mMenuDisplay = true;

	bool mPlayGame = false;
	bool mOptionDisplay = false;

	bool mDifficultyDisplay = false;
	bool mEasy = true;
	bool mMedium = false;
	bool mHard = false;

	bool mLanguageDisplay = false;
	bool mEnglish = false;
	bool mSpanish = false;
	bool mFrench = false;

	bool mSoundOn = true;
	int press = 0;

	bool mLoadSave = false;

	bool stop = false;
	//*************************

public:

	static void createInstance();
	static Game* getInstance();
	static void destroyInstance();

	void loadFiles();
	void init();
	void cleanup();
	void doLoop();
	void updateAndDraw(float targetTime);

	//HANDLE EVENTS
	virtual void handleEvent(const Event& theEvent);

};

//extern Game* gpGame;