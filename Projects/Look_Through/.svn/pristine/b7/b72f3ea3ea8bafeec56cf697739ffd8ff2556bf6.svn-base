#include "GraphicsBuffer.h"

using namespace std;

void GraphicsBuffer::clear()
{
	ALLEGRO_BITMAP* pOldBitmap = al_get_target_bitmap();
	al_set_target_bitmap(mpBitmap);
	al_clear_to_color(al_map_rgba(20,20,20,255));
	al_set_target_bitmap(pOldBitmap);

}

GraphicsBuffer::GraphicsBuffer( string &fileName )
{
	mpBitmap = al_load_bitmap( fileName.c_str() );
	mOwnBitmap = true;
	assert(mpBitmap);
}

GraphicsBuffer::GraphicsBuffer( Color col, int width, int height )
{
	ALLEGRO_BITMAP* pOldBitmap = al_get_target_bitmap();
	mpBitmap = al_create_bitmap( width, height );
	al_set_target_bitmap( mpBitmap );
	al_clear_to_color( col.getColor() );
	al_set_target_bitmap( pOldBitmap );
	mOwnBitmap = false;
}

GraphicsBuffer::~GraphicsBuffer()
{
	if( mOwnBitmap )
	{
		al_destroy_bitmap( mpBitmap );
		//delete mpBitmap;
		//mpBitmap = nullptr;
	}
}