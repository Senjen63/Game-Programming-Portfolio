#pragma once
#include <allegro5/allegro.h>
#include <allegro5/allegro_font.h>
#include <allegro5/allegro_ttf.h>
#include <allegro5/allegro_audio.h>
#include <allegro5/allegro_acodec.h>
#include <allegro5/allegro_image.h>
#include <allegro5/allegro_primitives.h>
#include <Trackable.h>
#include <Vector2D.h>
#include <iostream>
#include <cassert>
#include <string>
#include "GraphicsBuffer.h"
#include "Font.h"
#include "Sprite.h"
#include "Color.h"

using namespace std;

class GraphicsSystem
{
	friend GraphicsBuffer;
public:
	GraphicsSystem();
	GraphicsSystem(int height, int width);
	~GraphicsSystem();

	void init();
	void cleanUp();
	GraphicsBuffer* getBackBuffer();
	int getHeight();
	int getWidth();
	void flipDisplay();
	void border(Sprite* pSprite);
	void draw(Vector2D& targetLocation, Sprite sprite, float scale);
	void draw(GraphicsBuffer& targetBuffer, Vector2D& targetLocation, Sprite& sprite, float scale);
	void draw(Vector2D targetLocation, Sprite* pSprite, float randX, float randY);
	void draw(Vector2D targetLocation, Sprite* pSprite);
	void draw(GraphicsBuffer* pBuffer, Vector2D location, float scale);
	void writeText(Vector2D targetLocation, Font* font, Color color, string text);
	void writeText(GraphicsBuffer* targetBuffer, int x, int y, Font* font, Color color, string text);
	void saveBuffer(GraphicsBuffer& targetBuffer, const string& fileName);
	void clearToColor(GraphicsBuffer& targetBuffer, Color& color);
	bool isInit();
private:
	ALLEGRO_DISPLAY* mpDisplay;
	GraphicsBuffer* mpBack;
	int mHeight;
	int mWidth;
	bool mIsInit;
	ALLEGRO_DISPLAY* getDisplay()
	{
		return mpDisplay;
	};
};