#include "DeathScreen.h"
#include "Font.h"
#include "Color.h"
#include "Game.h"
#include "GraphicsBufferManager.h"
#include "GraphicsBuffer.h"
#include "GraphicsSystem.h"

using namespace std;

DeathScreen::DeathScreen()
{
	const string DEATH_SCREEN_KEY = "deathScreen";

	const string FONT_FILENAME = "cour.ttf";
	const int FONT_SIZE_TITLE = 48;
	const int FONT_SIZE_CONTINUE = 24;

	const string DEATH_SCREEN_TITLE = "You Died";
	const string DEATH_SCREEN_CONTINUE = "Do you want to continue? (Y/N)";
	const string TEXT_CENTER_ALIGN = "center";

	Font fontTitle = Font(FONT_SIZE_TITLE, FONT_FILENAME);
	Font fontContinue = Font(FONT_SIZE_CONTINUE, FONT_FILENAME);
	Color textColor = Color(255, 255, 255, 255);
	Color backgroundColor = Color(0, 0, 0, 255);

	const int WIDTH = 960 / 2;
	const int HEIGHT = 768 / 2;

	Game::getInstance()->getGraphicsBufferManager()->createAndAddGraphicsBuffer(DEATH_SCREEN_KEY, WIDTH, HEIGHT);

	Game::getInstance()->getGraphicsSystem()->setColor(Game::getInstance()->getGraphicsBufferManager()->getGraphicsBuffer(DEATH_SCREEN_KEY), &backgroundColor);

	Game::getInstance()->getGraphicsSystem()->writeText(Game::getInstance()->getGraphicsBufferManager()->getGraphicsBuffer(DEATH_SCREEN_KEY), Vector2D(WIDTH / 2, HEIGHT / 4), &fontTitle, &textColor, DEATH_SCREEN_TITLE, TEXT_CENTER_ALIGN);
	Game::getInstance()->getGraphicsSystem()->writeText(Game::getInstance()->getGraphicsBufferManager()->getGraphicsBuffer(DEATH_SCREEN_KEY), Vector2D(WIDTH / 2, HEIGHT / 2), &fontContinue, &textColor, DEATH_SCREEN_CONTINUE, TEXT_CENTER_ALIGN);

	this->mpDeathScreen = new Sprite(Game::getInstance()->getGraphicsBufferManager()->getGraphicsBuffer(DEATH_SCREEN_KEY)->getBitmapWidth(), Game::getInstance()->getGraphicsBufferManager()->getGraphicsBuffer(DEATH_SCREEN_KEY)->getBitmapHeight(), Vector2D(0, 0), Game::getInstance()->getGraphicsBufferManager()->getGraphicsBuffer(DEATH_SCREEN_KEY));
}

DeathScreen::~DeathScreen()
{
	delete mpDeathScreen;
}

void DeathScreen::drawDeathScreen()
{
	const int WIDTH = 960 / 2;
	const int HEIGHT = 768 / 2;

	Game::getInstance()->getGraphicsSystem()->draw(Vector2D(WIDTH - WIDTH / 2, HEIGHT - HEIGHT / 2), *mpDeathScreen);
}

