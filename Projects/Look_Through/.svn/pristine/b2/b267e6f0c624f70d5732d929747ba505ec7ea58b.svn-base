#include "Sprite.h"


Sprite::Sprite(std::string fullPath, Vector2D sourcePos, Vector2D size)
{
	mpBuffer = new GraphicsBuffer(fullPath);
	mSourcePos = sourcePos;
	mSize = size;
	mOwnsBuffer = true;
}


Sprite::Sprite(std::string fullPath, Vector2D sourcePos)
{
	mpBuffer = new GraphicsBuffer(fullPath);
	mSourcePos = sourcePos;
	mSize = Vector2D(al_get_bitmap_width(mpBuffer->getBitmap()), al_get_bitmap_height(mpBuffer->getBitmap()));
	mOwnsBuffer = true;
}


Sprite::Sprite(GraphicsBuffer* buffer, Vector2D sourcePos, Vector2D size)
{
	mpBuffer = buffer;
	mSourcePos = sourcePos;
	mSize = size;
	mOwnsBuffer = false;
}


Sprite::Sprite(GraphicsBuffer* buffer)
{
	mpBuffer = buffer;
	mSourcePos = Vector2D(0, 0);
	mSize = Vector2D(al_get_bitmap_width(buffer->getBitmap()), al_get_bitmap_height(buffer->getBitmap()));
	mOwnsBuffer = false;
}


Sprite::Sprite(Color color, Vector2D size)
{
	mpBuffer = new GraphicsBuffer(size);
	mSize = size;
	mOwnsBuffer = true;

	ALLEGRO_BITMAP* oldBitmap = al_get_target_bitmap();

	al_set_target_bitmap(mpBuffer->getBitmap());

	al_clear_to_color(color);

	al_set_target_bitmap(oldBitmap);
}


Sprite::~Sprite()
{
	if (mOwnsBuffer)
	{
		delete mpBuffer;
	}
}
