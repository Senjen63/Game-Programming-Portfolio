#include "ScreenChangeManager.h"

ScreenChangeManager::ScreenChangeManager()
{
}


void ScreenChangeManager::init()
{
	EventSystem::getInstance()->addListener((EventType)GameEventType::SNAKE_DIED, this);
	EventSystem::getInstance()->addListener((EventType)GameEventType::SNAKE_WON, this);
}


void ScreenChangeManager::handleEvent(const Event& theEvent)
{
	Game* g = Game::getInstance();

	if (theEvent.getType() == (EventType)GameEventType::SNAKE_WON)
	{
		if (g->mCurrentLevelIndex == g->NUM_LEVELS - 1)
		{
			g->mCurrentScreen = ScreenType::GAME_WIN_SCREEN;
		}
		else
		{
			g->mCurrentScreen = ScreenType::LEVEL_WIN_SCREEN;
		}

		g->mCurrentLevelIndex = (g->mCurrentLevelIndex + 1) % g->NUM_LEVELS;
	}
	else if (theEvent.getType() == (EventType)GameEventType::SNAKE_DIED)
	{
		g->mCurrentScreen = ScreenType::LOSE_SCREEN;
	}

	g->mInLevel = false;
}
