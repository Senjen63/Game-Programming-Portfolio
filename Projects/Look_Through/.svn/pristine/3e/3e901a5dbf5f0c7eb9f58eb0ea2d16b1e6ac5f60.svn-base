#pragma once
#include "Trackable.h"
#include "GraphicsSystem.h"
#include "InputSystem.h"
#include "LevelManager.h"
#include "Level.h"
#include "UnitManager.h"
#include "GraphicsBufferManager.h"
#include "Timer.h"
#include "Unit.h"
#include "Snake.h"
#include "EventListener.h"
#include "EventSystem.h"
#include "GameEvent.h"
#include "InputEvent.h"
#include "CollisionEvent.h"

class Game : public EventListener
{
public:
	bool init();
	void cleanUp();
	void doLoop();

	GraphicsSystem* getGraphicsSystem() { return mpGraphicsSystem; };
	InputSystem* getInputSystem() { return mpInputSystem; };
	void handleEvent(const Event& theEvent);


	static Game* getGameInstance();
	static Game* createGameInstance();
	static void destroyGameInstance();

	void createConsumable(Level* level, Snake* snake, bool food);

private:
	static Game* mpsInstance;
	bool mShouldContinue = true;
	Game();
	~Game();
	LevelManager* mpLevelManager;
	GraphicsSystem* mpGraphicsSystem;
	InputSystem* mpInputSystem;
	UnitManager* mpUnitManager;
	GraphicsBufferManager* mpGraphicsBuffManager;

	int mDirection = 0;
	bool mScored = false;
	bool mIsThereFood = false;
	bool mIsPoweredUp = false;
	bool newLevel = false;
};