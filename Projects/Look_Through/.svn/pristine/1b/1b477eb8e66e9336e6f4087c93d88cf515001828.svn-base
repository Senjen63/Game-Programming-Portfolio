#pragma once
#include <PerformanceTracker.h>
#include <MemoryTracker.h>
#include <Timer.h>
#include <string.h>
#include "GraphicsSystem.h"
#include "Animation.h"
#include "InputSystem.h"
#include "Unit.h"
#include "GraphicsBufferManager.h"
#include "MoveEvent.h"
#include "Listener.h"
#include "Vector2D.h"
#include "LevelManager.h"
#include "HUD.h"
#include "Audio.h"

const int DISP_WIDTH = 1200;
const int DISP_HEIGHT = 800;
const int SPRITE_WIDTH = 60;
const int SPRITE_HEIGHT = 60;
const int FONT_SIZE = 44;
const int SPRITE_SHEET_WIDTH = 4;
const int SPRITE_SHEET_HEIGHT = 4;
const float MOVE_DISTANCE = 60.0f;
const string FONT_PATH = "..\\assets\\sprites\\";
const string ASSET_PATH = "..\\assets\\sprites\\";
const string SOUND_PATH = "..\\assets\\sounds\\";
const string MENU_MUSIC = "mainMenuMusic.wav";
const string BACKGROUND_FILENAME = "background.bmp";
const string WALL_FILENAME = "wall.bmp";
const string SNAKE_FILENAME = "snake.bmp";
const string BULLET_FILENAME = "Bullet.bmp";
const string ENEMY_FILENAME = "enemy.bmp";
const string FONT_FILENAME = "cour.ttf";

class Game : public EventListener
{
public:
	static Game* getInstance();
	static void destroyInstance();
	void init();
	void cleanup();
	void doLoop();
	GraphicsSystem* getGraphicsSystem();
	UnitManager* getSnakeManager();
	GraphicsBufferManager* getGraphicsBufferManager();
	float getFrameTime();
	void saveToFile();
	virtual void handleEvent(const Event& event);
private:
	Game();
	~Game();

	static Game* mpsGame;
	GraphicsSystem* mpGraphicsSystem;
	InputSystem* mpInputSystem;
	GraphicsBufferManager* mpBufferManager;
	UnitManager* mpPlayerManager;
	UnitManager* mpWallManager;
	UnitManager* mpBulletManager;
	UnitManager* mpEnemyManager;
	UnitManager* mpEnemyManager2;
	float mFrameTime;
	EventSystem* mpSystem;
	Vector2D currPos = Vector2D(DISP_WIDTH/2, DISP_HEIGHT - 80);
	bool mLeft, mRight, mExit;
	string mKey;
	int mNumKey;
	Font* mpFont;
	Color blackColor = Color(0, 0, 0);
	Animation* mpEnemyAnimation;
	Level* mpLev1;
	Level* mpLev2;
	Level* mpLev3;
	Level* mpSaveLevel;
	HUD* mpHUD;
	Menu* mpHomeScreen;
	Menu* mpOptionsScreen;
	Menu* mpLoseScreen;
	Menu* mpWinScreen;
	LevelManager mLevelManager;
	LevelManager mMenuManager;
	int mpEnemyArray[13][20];
	int mpEnemyArray2[13][20];
	int mEnemyHitCount;
	bool mSound;

	string mpEnemyDeath, mpHighScore, mpPlayerDeath, mpPlayerShoot;
	Audio mpSounds;
};