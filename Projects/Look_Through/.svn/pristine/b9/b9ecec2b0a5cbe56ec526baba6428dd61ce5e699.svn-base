#include "GraphicsBufferManager.h"

GraphicsBufferManager::GraphicsBufferManager()
{
	//nothing
}

GraphicsBufferManager::~GraphicsBufferManager()
{
	clear();
}

//From lawson Manager and Singleton examples
void GraphicsBufferManager::clear()
{
	for (auto map : mMap)
	{
		GraphicsBuffer* pBuffer = map.second;
		delete pBuffer;
	}
	mMap.clear();
}

//From lawson Manager and Singleton examples
void GraphicsBufferManager::addBuffer(const BufferKey& key, string newBuffer)
{
	GraphicsBuffer* pBuffer = NULL;

	auto map = mMap.find(key);

	if (map == mMap.end())
	{
		pBuffer = new GraphicsBuffer(ASSET_PATH + newBuffer);
		mMap[key] = pBuffer;
	}
}

void GraphicsBufferManager::addBuffer(const BufferKey& key, GraphicsBuffer* buffer)
{
	auto map = mMap.find(key);

	if (map == mMap.end())
	{
		mMap[key] = buffer;
	}
}

//From lawson Manager and Singleton examples
void GraphicsBufferManager::removeBuffer(GraphicsBuffer* buffer)
{
	for (auto map : mMap)
	{
		if (buffer == map.second)
		{
			delete buffer;
			mMap.erase(map.first);
			return;
		}
	}
}

//From lawson Manager and Singleton examples
GraphicsBuffer* GraphicsBufferManager::getBuffer(const BufferKey& key) const
{
	auto map = mMap.find(key);

	if (map != mMap.end())
	{
		return map->second;
	}
	else
		return nullptr;
}