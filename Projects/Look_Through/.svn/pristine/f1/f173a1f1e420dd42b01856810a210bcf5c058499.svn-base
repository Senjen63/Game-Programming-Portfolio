#include "Unit.h"
#include "Game.h"
#include "InputSystem.h"

Unit::Unit()
{
	mPos = Vector2D();
	mCurrentAnimat = 1;
	mpAnimation1 = new Animation(Game::startUp()->getBuff(SMURF), FRAMES_PER_SECOND, START_TIME, true);
	mpAnimation2 = new Animation(Game::startUp()->getBuff(DEAN), FRAMES_PER_SECOND, START_TIME, true);
	mPaused = false;
	mTime = 0;
}

Unit::Unit(Vector2D position)
{
	mPos = position;
	mCurrentAnimat = 1;
	mpAnimation1 = new Animation(Game::startUp()->getBuff(SMURF), FRAMES_PER_SECOND, START_TIME, true);
	mpAnimation2 = new Animation(Game::startUp()->getBuff(DEAN), FRAMES_PER_SECOND, START_TIME, true);
	mPaused = false;
	mTime = 0;
}

Unit::Unit(Animation* pAnimation1, Animation* pAnimation2, Vector2D position)
{
	mPos = position;
	mCurrentAnimat = 1;
	mpAnimation1 = pAnimation1;
	mpAnimation2 = pAnimation2;
	mPaused = false;
	mTime = 0;
}

Unit::~Unit()
{
	mCurrentAnimat = 1;
	mpAnimation1 = nullptr;
	mpAnimation2 = nullptr;
}

void Unit::update(float time)
{
	time++;
	if (time > getTime() && !mPaused)
	{
		mpAnimation1->update();
		mpAnimation2->update();
	}
}

float Unit::getTime()
{
	return mpAnimation1->getTime();
}

Vector2D Unit::getPos()
{
	return mPos;
}

void Unit::draw(GraphicsSystem* pSystem)
{
	//cout << getSprite()->getLocation() << endl;
	pSystem->draw(mPos, getSprite(), 60, 60);
}

void Unit::setAnimation()
{
	if (mCurrentAnimat == 1)
	{
		mCurrentAnimat = 0;
	}
	else {
		mCurrentAnimat = 1;
	}
}

void Unit::setTime(float time)
{
	mpAnimation1->adjustTiming(time);
	mpAnimation2->adjustTiming(time);
}

Sprite* Unit::getSprite()
{
	if (mCurrentAnimat == 1)
	{
		return mpAnimation1->getCurrentSprite();
	}
	else
	{
		return mpAnimation2->getCurrentSprite();
	}
}

void Unit::togglePause()
{
	mPaused = !mPaused;
}