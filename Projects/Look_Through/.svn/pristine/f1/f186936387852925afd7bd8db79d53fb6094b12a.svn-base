#include "Animation.h"
#include "Sprite.h"

Animation::Animation(bool isLooping, double animTime)
{
	this->mCurrentSprite = 0;
	this->mLastSprite = 0;
	this->mAnimTime = animTime;
	this->mFramesPerSecond = animTime;
	this->mIsLooping = isLooping;
}

Animation::~Animation()
{
	mSprites.clear();
}

void Animation::addSprite(Sprite spriteToBeAdded)
{
	mSprites.push_back(spriteToBeAdded);
}

void Animation::update(double animTime)
{
	mFramesPerSecond -= animTime;

	if (mFramesPerSecond <= 0)
	{
		bool spriteIndexLowerThanListSize = mCurrentSprite < mSprites.size() - 1;
		bool spriteIndexSameAsListSize = mCurrentSprite == mSprites.size() - 1 && mIsLooping;

		if (spriteIndexLowerThanListSize)
		{
			mCurrentSprite++;
		}
		else if (spriteIndexSameAsListSize)
		{
			mCurrentSprite = 0;
		}

		mFramesPerSecond = mAnimTime;
	}
}

void Animation::changeAnimSpeed(float speedMultiplier)
{
	const int MAX_SPEED = 3000;
	const int MIN_SPEED = 100;

	if (mAnimTime >= MAX_SPEED)
	{
		mAnimTime = MAX_SPEED;
		return;
	}
	
	if (mAnimTime <= MIN_SPEED)
	{
		mAnimTime = MIN_SPEED;
		return;
	}

	mAnimTime *= speedMultiplier;
}