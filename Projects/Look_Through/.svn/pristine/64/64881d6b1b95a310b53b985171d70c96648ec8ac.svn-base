#include "Collectible.h"

Collectible::Collectible(UnitManager* manager, Animation* anim1, Animation* anim2, Animation* anim3, Animation* food, int initSpawnRate)
{
	mpUnitManager = manager;
	mpPowerAnimation1 = anim1;
	mpPowerAnimation2 = anim2;
	mpPowerAnimation3 = anim3;
	mpFoodAnimation = food;

	spawnRate = initSpawnRate;
}

Collectible::~Collectible()
{
}

void Collectible::setSpawnRate(int rate)
{
	spawnRate = rate;
}

void Collectible::spawnCollectible(int frame)
{
	Vector2D loc;
	int choice;
	int remainder;
	int x, y;

	srand(time(NULL));

	if (frame % spawnRate == 0)
	{
		choice = rand() % 3 + 1;

		//Randomize x coordinate within 60pix block grid
		loc.setX((rand() % 660));
		x = loc.getX();
		remainder = x % 60;
		loc.setX((loc.getX() - remainder) + 90);

		//Randomize y coordinate within 60pix block grid
		loc.setY((rand() % 420));
		y = loc.getY();
		remainder = y % 60;
		loc.setY((loc.getY() - remainder) + 90);

		if (choice == 1)
		{
			mpUnitManager->addUnit(mpPowerAnimation1, mpPowerAnimation1, loc, "Speed");
		}
		else if (choice == 2)
		{
			mpUnitManager->addUnit(mpPowerAnimation2, mpPowerAnimation2, loc, "Slow");
		}
		else if (choice == 3)
		{
			mpUnitManager->addUnit(mpPowerAnimation3, mpPowerAnimation3, loc, "Points");
		}
	}
}

void Collectible::spawnFood()
{
	Vector2D loc;
	int remainder;
	int x, y;

	srand(time(NULL));

	//Randomize x coordinate within 60pix block grid
	loc.setX((rand() % 660));
	x = loc.getX();
	remainder = x % 60;
	loc.setX((loc.getX() - remainder) + 90);

	//Randomize y coordinate within 60pix block grid
	loc.setY((rand() % 420));
	y = loc.getY();
	remainder = y % 60;
	loc.setY((loc.getY() - remainder) + 90);

	mpUnitManager->addUnit(mpFoodAnimation, mpFoodAnimation, loc, "Food");
}