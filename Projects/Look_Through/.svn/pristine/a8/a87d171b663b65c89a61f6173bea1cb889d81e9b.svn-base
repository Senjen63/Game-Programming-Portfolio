#include "GraphicsBuffer.h"

using namespace std;

GraphicsBuffer::GraphicsBuffer(ALLEGRO_BITMAP* bitmap) 
{
	pBitmap = bitmap;
	assert(pBitmap);

	ownsBitmap = false;
}

GraphicsBuffer::GraphicsBuffer(int width, int height) 
{
	pBitmap = al_create_bitmap(width, height);
	assert(pBitmap);

	ownsBitmap = false;
}

GraphicsBuffer::GraphicsBuffer(string filename) 
{
	pBitmap = al_load_bitmap(filename.c_str());
	assert(pBitmap);

	ownsBitmap = true;
}

GraphicsBuffer::~GraphicsBuffer() 
{
	if (ownsBitmap) { al_destroy_bitmap(pBitmap); }
}

void GraphicsBuffer::setColor(Color col) 
{
	ALLEGRO_BITMAP* oldBitmap = al_get_target_bitmap();
	al_set_target_bitmap(pBitmap);
	al_clear_to_color(col.getColor());
	al_set_target_bitmap(oldBitmap);
}