#pragma once
#include "Trackable.h"
#include "AudioSystem.h"
#include "GraphicsSystem.h"
#include "AnimationManager.h"
#include "InputSystem.h"
#include "LevelManager.h"
#include "Level.h"
#include "UnitManager.h"
#include "GraphicsBufferManager.h"
#include "Timer.h"
#include "Unit.h"
#include "Snake.h"
#include "EventListener.h"
#include "EventSystem.h"
#include "GameEvent.h"
#include "InputEvent.h"
#include "CollisionEvent.h"
#include "SaveData.h"
#include "SDL_ttf.h"

class Game : public EventListener
{
public:
	bool init();
	void cleanUp();
	void doLoop();

	GraphicsSystem* getGraphicsSystem() { return mpGraphicsSystem; };
	InputSystem* getInputSystem() { return mpInputSystem; };
	void handleEvent(const Event& theEvent);


	static Game* getGameInstance();
	static Game* createGameInstance();
	static void destroyGameInstance();

	void createConsumable(Level* level, Snake* snake, bool food);

private:
	static Game* mpsInstance;
	bool mShouldContinue = true;
	bool mStartLevel = false;
	bool mEnterSettings = false;
	bool mLangSetEN = true;
	bool mLangSetES = false;
	bool mLangSetFR = false;
	bool mSetEasy = true;
	bool mSetHard = false;
	bool mPlayerOneWin = false;
	bool mPlayerTwoWin = false;
	bool mSnakeOne = false;

	Audio* mpMusic = nullptr;
	Audio* mpClick = nullptr;
	Audio* mpCrash = nullptr;

	Game();
	~Game();
	LevelManager* mpLevelManager;
	GraphicsSystem* mpGraphicsSystem;
	InputSystem* mpInputSystem;
	UnitManager* mpUnitManager;
	AnimationManager* mpAnimationManager;
	AudioSystem* mpAudioSystem;
	GraphicsBufferManager* mpGraphicsBuffManager;
	SaveData* mpSaveData;


	int mSnake1Score = 0;
	int mSnake2Score = 0;
	int mDirection = 0;
	int mDirection2 = 0;
	bool mScored = false;
	bool mIsThereFood = false;
	bool mIsPoweredUp = false;
	bool newLevel = false;
};